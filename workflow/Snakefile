import sys
import peppy

singularity: "docker://continuumio/miniconda3"
configfile: "config/config.yaml"
pepfile: "config/pep.yaml"

SAMPLES = [x.sample_name for x in pep.samples]
SUBSAMPLE_TABLE = pep.subsample_table[0]

rule all:
    input:
        expand("results/filt/{s}.{f}", s=SAMPLES,f=['bam','bam.bai'])

include: "rules/trim.smk"
include: "rules/variants.smk"

rule samtools_index:
    input:
        "{file}.bam"
    output:
        "{file}.bam.bai"
    params:
        "" # optional params string
    wrapper:
        "0.70.0/bio/samtools/index"
